---
title: "benap_OriginalHomeworkCode_02"
author: "Ben Peters"
date: "2025-02-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Every Saturday morning, at the same time, a primatologist goes and sits in the forest to listen for titi monkey calls, counting the number of calls they hear in a 2 hour window from 5am to 7am. Based on previous knowledge, she believes that the mean number of calls she will hear in that time is exactly 15. Let X represent the appropriate Poisson random variable of the number of calls heard in each monitoring session.

```{r} 
# let's start by assigning X as a Poisson random distribution of the number of calls heard in a 2 hour monitoring session
X <- dpois(0:40,15) #this defines X as a poisson distribution with a mean of 15 over the interval of 0-40 (I just chose the max more or less at random to just try and get a full spread of the distribution)
barplot(X, names.arg = 0:40, space = 0, xlab = "calls", ylab = "Pr(X = x)", main = "Call # Probability Mass Function") #this plots the above generated distribution just to check that it looks right
```

What is the probability that she will hear more than 8 calls during any given session?

```{r}
ppois(8, 15, lower.tail = FALSE) #ppois returns the cumulative distribution function for a given lambda (in our case 15) and value within the distribution (in our case 8 for the number of calls we're trying to determine the probability for), we specify lower.tail = FALSE to ensure we're finding the probability of the upper tail (i.e. greater than our given value of 8)
```
```{r}
barplot(ppois(8:40, lambda = 15, lower.tail = FALSE), ylim = 0:1, names.arg = 8:40, xlab = "x",
    ylab = "Pr(X > x)", main = "Cumulative Call Probability") # we can visualize the cumulative probability distribution by plotting ppois between our lower value (8) and an undetermined max (I use 40 here, it can theoretically go to infinity but our probability is already essentially at 0 well before we hit 30)
```

What is the probability that she will hear no calls in a session?

```{r}
ppois(0, 15) # as before we use the ppois function to return the cumulative distribution, though this time we leave lower.tail = TRUE to find the probability X <= x (inclusive). Since we're essentially finding the probability in a range from 0 to 0 it's astronomically low,
```
```{r}
barplot(ppois(0:30, lambda = 15), ylim = 0:1, names.arg = 0:30, xlab = "x",
    ylab = "Pr(X <= x)", main = "Cumulative Call Probability") #same as before we're plotting the probability distribution, though since lower.tail = TRUE this time note that the distribution appears inverted to the previous plot. We're finding the probability X <= x, instead of X > x
```
```{r}
#technically I think it'd be better to answer this question like this tho:

dpois(0,15) # since this returns the direct probability of a single value rather than a spread, though note that both answers are the same: 3.059023e-07
```
What is the probability that she will hear exactly 3 calls in a session?

```{r}
# now we return to using the dpois function
dpois(3, 15) # return the probability for a single value (3) given a poisson distribution with a mean of 15
```

Plot the relevant Poisson mass function over the values in range 0 ≤ x ≤ 30.
```{r}
barplot(dpois(0:30, 15), names.arg = 0:30, space = 0, xlab = "# of calls", ylab = "Pr(X = x)", main = "Call # Probability Mass Function") # see above for a discussion of dpois, the plot here is the same, just over the range 0:30
```

Simulate 104 results from this distribution (i.e., 2 years of Saturday monitoring sessions).

```{r}

```

